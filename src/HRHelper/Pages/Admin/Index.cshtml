@page
@model HRHelper.Pages.Admin.IndexModel
@using System.Reflection
@using Microsoft.Extensions.Localization
@inject IConfiguration Configuration
@inject IStringLocalizer<HRHelper.SharedResource> L
@{
	ViewData["Title"] = L["Admin_Title"];
	var rawVer = (Configuration?["APP_VERSION"] as string) ?? (Assembly.GetEntryAssembly()?.GetName().Version?.ToString() ?? "dev");
	var dashIdx = rawVer.LastIndexOf('-');
	var displayVersion = (dashIdx >= 0 && dashIdx < rawVer.Length - 1) ? rawVer.Substring(dashIdx + 1) : rawVer;
}
<p style="font-size:0.85em;color:#555;margin-top:-0.5rem">@L["Footer_Version"] - @displayVersion</p>
<p><a href="/admin/create">@L["Admin_Create"]</a> | <a href="/admin/templates">@L["Admin_Templates"]</a></p>
<h3>@L["Admin_Links"]</h3>
<table>
	<thead><tr><th>@L["Admin_Table_Title"]</th><th>@L["Admin_Table_Type"]</th><th>@L["Admin_Table_Link"]</th><th>@L["Admin_Table_Expires"]</th></tr></thead>
	<tbody>
	@foreach (var r in Model.Requests)
	{
		<tr>
			<td>@r.Title</td>
			<td>@r.Type</td>
			<td><a href="@Model.GetLink(r)" target="_blank">@Model.GetLink(r)</a></td>
			<td>@r.ExpiresAt.UtcDateTime.ToString("u")</td>
		</tr>
	}
	</tbody>
</table>
<h3>Completed submissions</h3>
<ul>
	@foreach (var s in Model.Submissions)
	{
		<li>@s.SubmittedAt.UtcDateTime.ToString("u") â€” @s.SpecialRequest?.Title</li>
	}
</ul>
